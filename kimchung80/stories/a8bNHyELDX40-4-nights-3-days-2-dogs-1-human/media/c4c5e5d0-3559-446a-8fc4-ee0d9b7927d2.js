webpackJsonp([28],{0:function(t,e,i){t.exports=i(34)},34:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(48),o=i(63),a=i(50),l=i(90),h=s.createClass({displayName:"StoryPage",mixins:[a],getShareImageRep:function(){var t=this.get("story").share_image||this.get("story").cover_media.image||this.get("story").cover_media.video.poster_image;return t&&t.representations&&t.representations[1024]&&t.representations[1024].url?t.representations[1024]:(console.warn("Broken share image.",t),null)},authenticate:function(t){this.props.offline||o.get("/api/v1/users/me/relations",{"story_ids[]":this.get("story").id,"user_ids[]":this.get("story").user.id},t)},render:function(){var t=this.get("story").user.full_name||this.get("story").user.username||"",e=t?" by "+t:"",i=this.props.offline?(this.get("story").title||"Untitled")+(""+e):(this.get("story").title||"Untitled")+(""+e+" - Storehouse");return s.createElement(r,n({},this.props,{data:this.props,styles:["fonts","common"],title:i,description:this.get("story").subtitle||"Story by "+t,shareImageRep:this.getShareImageRep(),author:t,url:this.get("story").url,appUrl:"storehouse://stories_by_slug/"+this.get("story").slug,onAuthenticate:this.authenticate}),s.createElement(l,{offline:this.props.offline}))}});r.init(h),t.exports=h},85:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(57),o=i(49),a=i(58),l=i(77),h=i(47),p=i(71),c=i(50),u=i(112),d=i(125),g=i(152),m=(i(153),s.addons.classSet),f=s.createClass({displayName:"StaticHeader",mixins:[c],getDefaultProps:function(){return{height:56}},onLogout:function(){"/"===window.location.pathname&&(window.location.href=window.location.href)},render:function(){if(this.props.offline)return null;if(h.isiOS()||h.isAndroid())return s.createElement(g,this.props);var t=this.props.extraWide?"mtm mlm":"",e=this.props.extraWide?"mtm mrm pts":"mtm";return s.createElement("div",n({},this.props,{className:r.joinClasses(this.props.className,"centered"),style:Object.assign({},this.props.style,{height:this.props.height,width:this.props.width,lineHeight:this.props.height+"px"})}),s.createElement("div",{className:"full-width nobr top-left rel z1"},s.createElement("div",{className:r.joinClasses(t,"abs top-left")},this.renderLeftSide()),s.createElement("div",{className:"center"},this.renderCenter()),s.createElement("div",{className:r.joinClasses(e,"abs top-right")},this.renderRightSide())))},renderLeftSide:function(){return s.createElement("div",null,s.createElement("a",{href:"/"},s.createElement(o,{className:m({mid:!0,mls:!this.props.storyPage}),icon:i(94),iconStyle:this.props.transBackground?"light":"dark",scale:1})),this.renderRomaLink())},renderCenter:function(){return null},renderRightSide:function(){return this.props.offline?null:this.props.profilePage||l.features.disableGetAppButtons?this.get("currentUser").loggedIn?this.renderLoggedInButtons():this.renderLoggedOutButtons():this.renderGetAppButtons()},renderLoggedInButtons:function(){return s.createElement("div",{className:"ib mid aa"},s.createElement(d,{buttonStyle:this.props.transBackground?a.transWhite:a.white,className:"phm",rounded:!0,afterLogOut:this.onLogout}))},renderLoggedOutButtons:function(){return this.get("currentUser").loading?null:s.createElement("div",{className:"ib mid aa"},s.createElement(u,{buttonStyle:this.props.transBackground?a.transWhite:a.white,className:"phm",rounded:!0,action:this.props.onLogIn}))},renderGetAppButtons:function(){return s.createElement("div",null,this.renderAppStoreButton(),this.renderPlayStoreButton())},renderAppStoreButton:function(){return s.createElement("a",n({},p.appStoreLinkProps("header"),{className:"mrs ib common-appstore"}))},renderPlayStoreButton:function(){return s.createElement("a",{href:p.playStoreLink("header"),className:"ib common-playstore"})},getRomaUrl:function(){return this.props.storyPage?"/roma/users/"+this.get("story").user.id+"/stories/"+this.get("story").id:"/roma/home"},renderRomaLink:function(){if(!this.get("currentUser")||!this.get("currentUser").is_admin)return null;var t=i(49);return s.createElement("a",{href:this.getRomaUrl(),className:"rel pls",style:{top:17.5}},s.createElement(t,{icon:i(130),color:"light-gray"}))}});t.exports=f},90:function(t,e,i){"use strict";var n=function(t,e){var i={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(41),o=i(57),a=i(77),l=i(42),h=i(47),p=i(63),c=i(50),u=i(66),d=i(100),g=i(59),m=i(85),f=i(43),y=i(163),v=i(105),b=i(149),w=i(153),x=5e3,E=r.createClass({displayName:"Story",mixins:[g,c,u],getDefaultProps:function(){return{x:0,y:0}},getInitialState:function(){return{gridHeight:-1e5,footerHeight:null}},getStory:function(){return this.get("story")},getAppURL:function(){var t=this.get("story");return t["private"]?"storehouse://stories_by_slug/"+t.slug:"storehouse://view/story/"+t.id},componentDidMount:function(){this.checkScrollbars(),this.props.offline||this.onStoryViewed(),this.getStory().is_processing&&this.pollStory()},componentDidUpdate:function(){this.checkScrollbars()},showStory:function(t,e){if(!t){var i=e.story;if(!i.is_processing)return void d.updateStory(i)}this.pollStory()},pollStory:function(){var t=this.getStory().id;setTimeout(function(){p.get("/api/v1/stories/"+t,this.showStory)}.bind(this),x)},onStoryViewed:function(){p.post("/api/v1/stories/"+this.get("story").id+"/viewed_web",{"story_ids[]":this.get("story").id},function(t,e){t||d.logInSuccess({auth_token:e.auth_token,user:e.current_user,stories:[e.story],users:[e.story.user]})})},render:function(){var t=this.getTopGap(),e=this.getCoverHeight(),i=this.getHeaderHeight();this.props.cover===!1&&(e=0);var a=this.getStory(),l=this.props,h=(l.x,l.y),p=n(l,["x","y"]);return r.createElement("div",s({},p,{style:o.merge(this.props.style,{height:h+t+i+e+5*f.getGutter(this.state.windowWidth)+this.state.gridHeight})}),this.renderMessageBanner(),r.createElement(m,{width:this.getCoverWidth(),height:i,storyPage:!0,offline:this.props.offline}),this.props.cover!==!1&&r.createElement(v,{story:a,x:this.state.windowWidth/2,y:h+t+i+e/2,width:this.getCoverWidth(),height:e,expanded:!0,parallax:!0,showAuthor:!0,appURL:this.getAppURL(),offline:this.props.offline}),r.createElement(b,{elements:a.elements,width:this.state.windowWidth,windowWidth:this.state.windowWidth,windowHeight:this.state.windowHeight,x:this.state.windowWidth/2,y:h+t+i+e+f.getGutter(this.state.windowWidth),onHeightChange:this.onGridHeightChange}),r.createElement(y,{story:a,width:this.state.windowWidth,windowHeight:this.state.windowHeight,height:null,x:this.state.windowWidth/2,y:h+t+i+e+2*f.getGutter(this.state.windowWidth)+this.state.gridHeight,offsetY:0,onHeightChange:this.onFooterHeightChange,offline:this.props.offline}))},checkScrollbars:o.frame(function(){document.body.clientWidth!==this.state.windowWidth&&(l.updateSize(),l.onResize.trigger())}),getTopGap:function(){return this.props.offline?h.isAndroid()||h.isiOS()?0:56:a.features.messageBanner&&this.get("currentUser").loggedIn?56:0},getHeaderHeight:function(){return this.props.offline?0:h.hasTouch()?56:106},getCoverWidth:function(){return h.hasTouch()?this.state.windowWidth:f.getSizeOfColumns(this.state.windowWidth,6)},getCoverHeight:function(){return f.getCoverHeight(this.getCoverWidth(),this.state.windowHeight)},getFooterHeight:function(){return this.state.footerHeight||120},onGridHeightChange:function(t){this.setState({gridHeight:t}),this.onHeightChange()},onFooterHeightChange:function(t){this.setState({footerHeight:t}),this.onHeightChange()},onHeightChange:o.frame(function(){this.state.gridHeight<=0||this.props.onHeightChange&&this.props.onHeightChange(this.getTopGap()+this.getHeaderHeight()+this.getCoverHeight()+4*f.getGutter(this.state.windowWidth)+this.state.gridHeight+this.getFooterHeight())}),updateStory:function(t){this.setState({story:t})},renderMessageBanner:function(){return a.features.messageBanner&&this.get("currentUser").loggedIn?r.createElement(w,null):null}});t.exports=E},146:function(t,e,i){"use strict";function n(t){t&&!t.initialized&&t.config.autoInitialize&&t.init()}var s=i(57),r=i(47),o=i(72),a=i(200).ReactScriptLoader,l={mixins:[o],getInitialState:function(){return{rangy:null}},loadRangy:function(t){this.state.rangy||r.isServer()||(a.componentDidMount(this.getScriptURL(),this,this.getScriptURL()),this._loadRangyCallback=t)},componentWillUnmount:function(){this.state.rangy&&a.componentWillUnmount(this.getScriptURL(),this.getScriptURL())},getScriptURL:function(){return this.asset("rangy-8efcb80f.js")},onScriptError:function(){},onScriptLoaded:s.safe(function(){var t=i(176).rangy;n(t),this.setState({rangy:t}),this._loadRangyCallback&&this._loadRangyCallback()})};t.exports=l},147:function(t,e,i){"use strict";var n=i(46),s=i(47),r={componentDidMount:function(){s.isFirefox()&&(this._dragOverListener=n.addFallbackListener("dragover",this._dragOverCallback))},componentWillUnmount:function(){this._dragOverListener&&this._dragOverListener.unsubscribe()},_dragOverCallback:function(t){this._dragPosition=[t.clientX,t.clientY]},getDragCoordinates:function(t){return this._dragPosition||[t.clientX,t.clientY]}};t.exports=r},149:function(t,e,i){"use strict";var n=function(t,e){var i={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(41),o=i(57),a=i(46),l=i(121),h=i(47),p=i(71),c=i(66),u=i(204),d=i(205),g=i(206),m=i(43),f=i(207),y=r.addons.classSet,v=r.createClass({displayName:"StoryGrid",mixins:[c,u,f],getInitialState:function(){return{elementHeights:{},expandedElement:null,expanding:!1}},componentDidMount:function(){this._listeners=[],this._listeners.push(a.addFallbackListener("keydown",this.onKeyDown)),this.updateHeight()},componentDidUpdate:function(){this.updateHeight()},componentWillUnmount:function(){for(var t;t=this._listeners.shift();)t.unsubscribe()},focusElement:function(t){var e=t.id;this.refs[e]&&this.refs[e].focus()},render:function(){var t=this.props.editing?d:g,e=0,i=this.computePositions().map(function(i,n){var o=i.element,a=i.isExpandable,l=i.height,h=i.actualHeight,p=i.y,c=h||l;return e=Math.max(e,p+c-this.props.y+this.getMargin(this.props.elements[this.props.elements.length-1],null)),r.createElement(t,s({},i,{height:l,offsetY:0,editing:this.props.editing,windowWidth:this.props.windowWidth,windowHeight:this.props.windowHeight,rangy:this.props.rangy,onHeightChange:this.onElementHeightChange.bind(this,o.id),ref:o.id,key:o.id,className:y({pointer:a}),expandable:a,isFirstInGrid:a&&!this.getAdjacentImage(o.id,-1),isLastInGrid:a&&!this.getAdjacentImage(o.id,1),expanded:this.state.expandedElement===o.id,staged:this.getStagedPosition(n),dragX:(this.state.expandedElement===o.id||this.getStagedPosition(n))&&this.state.dragX,isRendered:!0,onClick:a&&this.toggleElement.bind(this,o.id),onExpandingDone:this.onElementExpandingDone.bind(this,o.id)}))},this);i=i.sort(function(t){return t.key}),this._totalHeight=e;var o=this.props,a=(o.width,o.x,o.y),l=o.style,h=n(o,["width","x","y","style"]);return r.createElement("div",s({},h,{style:Object.assign({},l,{height:a+e})}),i)},updateHeight:function(){(void 0===this._lastHeight||Math.round(this._totalHeight)!==Math.round(this._lastHeight))&&(this._lastHeight=this._totalHeight,this.props.onHeightChange&&this.props.onHeightChange(this._totalHeight))},onElementHeightChange:function(t,e){this.setState(o.update({},"element-"+t+"-height",e))},onElementExpandingDone:function(){this.setState({expanding:!1})},getMargin:function(t,e){var i=this.getElementType(t),n=this.getElementType(e),s=m.verticalMargins[i][n];return m.getGutter(this.props.width)*(s-1)},getElementType:function(t){return t&&"text"==t.content.type?t.content.text.text_style:"media"},onTouchMove:function(t){this.state.expandedElement&&t.preventDefault()},onKeyDown:function(t){if(this.state.expandedElement){switch(t.keyCode){case 39:this.switchElement(1);break;case 37:this.switchElement(-1);break;case 27:this.dismiss()}return!1}},onSwipeRight:function(t){this.switchElement(-1,t)},onSwipeLeft:function(t){this.switchElement(1,t)},onSwipeCancel:function(t){this.switchElement(0,t)},switchElement:function(t,e){if(this.state.expandedElement){if(this.state.expanding)return this.setState({expanding:!1}),requestAnimationFrame(this.switchElement.bind(this,t,e));this.setSwipeVelocity(e);var i=this.getAdjacentImage(this.state.expandedElement,t);if(!i)return void(h.hasTouch()||this.setSwipeVelocity(-1e3*t));this.setState({expandedElement:i.id});var n=t>0?this.getNext(i.id):this.getPrev(i.id),s=this.refs[n];s&&!h.hasTouch()&&s.getDOMNode().scrollIntoView(0>t)}},toggleElement:function(t){return t===this.state.expandedElement?(this.setState({expandedElement:null}),void l.setProps({dim:!1,onClick:this.dismiss})):(p.action("Element Expanding",{"Element Id":t}),this.setState({expandedElement:t,expanding:!0}),void l.setProps({dim:!0,opacity:1,dark:!1,onClick:this.dismiss}))},dismiss:function(){this.state.expandedElement&&this.toggleElement(this.state.expandedElement)},setSwipeVelocity:function(t){if(void 0!==t&&this.state.expandedElement)for(var e,i,n=this.getIndexById(this.state.expandedElement),s=n-1;n+1>=s;s++)e=this.props.elements[s],e&&(i=this.refs[e.id],i.setSwipeVelocity(t))},getStagedPosition:function(t){if(!this.state.expandedElement)return null;if(this.state.expanding)return null;var e=this.props.elements[t];if(!this.isExpandableElement(e))return null;var i=this.getIndexById(this.state.expandedElement);if(i===t)return null;var n=t-i;return Math.abs(n)<=1?n:null},getAdjacentImage:function(t,e){var i=e>0?this.getNext(t):0>e?this.getPrev(t):t;if(!i)return null;var n=this.getElementById(i);return this.isExpandableElement(n)?n:null},getElementById:function(t){return this.props.elements[this.getIndexById(t)]},getIndexById:function(t){for(var e=0,i=this.props.elements.length;i>e;e++)if(this.props.elements[e].id===t)return e},getNext:function(t){return this.getNextId(this.getIndexById(t))},getPrev:function(t){return this.getPrevId(this.getIndexById(t))},getNextId:function(t){var e=this.props.elements[t+1];return e?e.id:null},getPrevId:function(t){var e=this.props.elements[t-1];return e?e.id:null},isGridElement:function(t){return"grid"===t.layout_type},isExpandableElement:function(t){return"image"===t.content.type&&!t.content.image.is_processing||"video"===t.content.type&&!t.content.video.is_processing||!1},isTextElement:function(t){return"text"===t.content.type}});t.exports=v},152:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(49),o=i(58),a=i(77),l=i(47),h=i(50),p=i(112),c=i(125),u=i(208),d=s.createClass({displayName:"MobileStaticHeader",mixins:[h],render:function(){return s.createElement("div",n({},this.props,{style:Object.assign({},this.props.style,{height:this.props.height,backgroundColor:a.features.disableGetAppButtons||this.props.transBackground||!this.props.storyPage?null:"#111111"})}),s.createElement("div",{className:"full-width nobr top-left rel"},s.createElement("div",{className:"abs top-left"},this.renderLeftSide()),s.createElement("div",{className:"center"},this.renderCenter()),s.createElement("div",{className:"abs top-right"},this.renderRightSide())))},renderLeftSide:function(){return a.features.disableGetAppButtons||!this.props.storyPage?null:s.createElement("div",{className:"abs",style:{top:7,left:7}},s.createElement(r,{icon:i(198),className:"ib mid",iconStyle:"beta"}),s.createElement("div",{className:"ib mid mls",style:{lineHeight:"1.4"}},s.createElement(r,{icon:i(192),iconStyle:"light"}),s.createElement("div",{className:"medlight-gray aa",style:{fontSize:12}},l.isiOS()&&"Free on the App Store",l.isAndroid()&&"Free on the Play Store")))},renderCenter:function(){return!a.features.disableGetAppButtons&&this.props.storyPage?null:s.createElement("div",{className:"ib ptm",style:{paddingTop:18}},s.createElement(r,{icon:i(192),iconStyle:"dark",scale:1.25}))},renderRightSide:function(){return this.props.offline?null:!a.features.disableGetAppButtons&&this.props.storyPage?this.renderGetAppButton():this.get("currentUser").loggedIn?this.renderRightSideLoggedIn():this.renderRightSideLoggedOut()},renderRightSideLoggedIn:function(){return s.createElement("div",{className:"abs",style:{top:8,right:10}},s.createElement(c,{className:"aa phm",buttonStyle:o.white}))},renderRightSideLoggedOut:function(){return this.get("currentUser").loading?null:s.createElement("div",{className:"abs",style:{top:8,right:10}},s.createElement(p,{buttonStyle:o.white,className:"aa phm",action:this.props.onLogIn}))},renderGetAppButton:function(){return s.createElement("div",{className:"abs",style:{top:13,right:10}},s.createElement(u,{storyPage:this.props.storyPage,trackingSource:"mobile_banner"}))}});t.exports=d},153:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(57),o=(i(49),i(58)),a=(i(47),i(71),i(50)),l=(i(112),i(125),i(152),i(54)),h=(s.addons.classSet,s.createClass({displayName:"MessageStaticHeader",mixins:[a],getDefaultProps:function(){return{height:56}},render:function(){return s.createElement("div",n({},this.props,{className:r.joinClasses(this.props.className,"centered"),style:Object.assign({},this.props.style,{height:this.props.height,width:this.props.width,lineHeight:this.props.height+"px"})}),s.createElement("div",{className:"messagebar full-width nobr top-left rel z1 text-xs"},s.createElement("div",{className:"center"},"An important message from Storehouse",s.createElement(o,{buttonStyle:o.transWhiteOutline,rounded:!0,className:"ib aa mlm",style:{fontSize:12,lineHeight:"28px"},loading:!1,href:"/letter"},l("Read More")))))}}));t.exports=h},163:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(57),o=i(214),a=i(66),l=i(64),h=i(54),p=s.createClass({displayName:"StoryFooter",mixins:[a],render:function(){return this.props.offline?null:s.createElement(l,n({},this.props,{className:r.joinClasses(this.props.className,"center")}),s.createElement(o,{width:this.props.width,minimal:!0},s.createElement("a",{href:"/",className:"mtm text-xs block light-gray aa"},h("Made with Storehouse"))))}});t.exports=p},176:function(t){t.exports=rangy},200:function(t,e){"use strict";var i={},n={},s={},r=0,o={componentDidMount:function(t,e,r){if("function"!=typeof e.onScriptLoaded)throw new Error("ScriptLoader: Component class must implement onScriptLoaded()");if("function"!=typeof e.onScriptError)throw new Error("ScriptLoader: Component class must implement onScriptError()");if(n[r])return void e.onScriptLoaded();if(s[r])return void e.onScriptError();if(i[r])return void(i[r][t]=e);var o={};o[t]=e,i[r]=o;var a=document.createElement("script");a.src=r;var l=function(t){var e=i[r];for(var n in e){var s=e[n],o=t(s);o&&delete i[r][n]}};a.onload=function(){n[r]=!0,l(function(t){return t.deferOnScriptLoaded&&t.deferOnScriptLoaded()?!1:(t.onScriptLoaded(),!0)})},a.onerror=function(){s[r]=!0,l(function(t){return t.onScriptError(),!0})},document.body.appendChild(a)},componentWillUnmount:function(t,e){var n=i[e];n&&delete n[t]},triggerOnScriptLoaded:function(t){if(!n[t])throw new Error("Error: only call this function after the script has in fact loaded.");var e=i[t];for(var s in e){var r=e[s];r.onScriptLoaded()}delete i[t]}},a={componentDidMount:function(){if("function"!=typeof this.getScriptURL)throw new Error("ScriptLoaderMixin: Component class must implement getScriptURL().");o.componentDidMount(this.__getScriptLoaderID(),this,this.getScriptURL())},componentWillUnmount:function(){o.componentWillUnmount(this.__getScriptLoaderID(),this.getScriptURL())},__getScriptLoaderID:function(){return"id"+r++}};e.ReactScriptLoaderMixin=a,e.ReactScriptLoader=o},201:function(t,e,i){"use strict";var n=i(120),s={componentDidUpdate:function(){this._renderLayer()},componentDidMount:function(){this._renderLayer()},_renderLayer:function(){var t=this.renderLayer();n.render(t,this)},layerWillUnmount:function(){}};t.exports=s},204:function(t,e,i){"use strict";var n=i(46),s=i(47),r={_dragElement:function(t,e){this.setState({dragX:e.dx})},_dragEnd:function(t,e){this.setSwipeVelocity&&this.setSwipeVelocity(e.vx);var i=(this.props.windowWidth||this.props.width)/2,n=Math.abs(e.vx)>100?e.vx:Math.abs(e.dx)>i?e.dx:0;0>n?this.onSwipeLeft(e.vx):n>0?this.onSwipeRight(e.vx):this.onSwipeCancel(e.vx),this.setState({dragX:0})},componentDidMount:function(){if(this._swipeListeners=[],s.hasTouch()){var t=this.getDOMNode();this._swipeListeners.push(n.addEventListener(t,"swipe",this._dragElement)),this._swipeListeners.push(n.addEventListener(t,"swipeend",this._dragEnd)),this.onTouchMove&&this._swipeListeners.push(n.addEventListener(t,"touchmove",this.onTouchMove))}},componentWillUnmount:function(){for(var t;t=this._swipeListeners.shift();)t.unsubscribe()},isGrabbed:function(){return!!this.state.dragX}};t.exports=r},205:function(t,e,i){"use strict";var n=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var i,n=[],s=t[Symbol.iterator]();!(i=s.next()).done&&(n.push(i.value),!e||n.length!==e););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(41),o=i(57),a=i(120),l=i(50),h=i(109),p=i(201),c=i(100),u=i(237),d=i(64),g=i(238),m=i(239),f=i(240),y=i(43),v=i(241),b=i(242),w=i(243),x=r.addons.classSet,E=r.PropTypes,S=r.createClass({displayName:"EditableStoryElement",mixins:[p,l,g,u,h],propTypes:{element:E.object.isRequired,windowWidth:E.number.isRequired},getInitialState:function(){return{size:{x:0,y:0},focalpoint:{x:0,y:0},width:this.props.width,height:this.props.height,focus:!1}},componentDidMount:function(){this.toggleHovering=o.debounce(this.toggleHovering,100)},componentWillReceiveProps:function(t){var e={};this.isBlock()&&this.state.width!==t.width&&(e=o.update(e,"width",t.width)),(this.props.windowWidth!==t.windowWidth||this.props.windowHeight!==t.windowHeight)&&(e=o.update(e,"width",t.width),o.isSet(t.height)&&(e=o.update(e,"height",t.height))),Object.keys(e).length&&this.setState(e)},componentWillUnmount:function(){this._layerDestroyed||a.destroy(this)},getGridDimensions:function(t){var e=t.x,i=t.y,n=this.props.windowWidth,s=o.constrain(y.getColumnsFromSize(n,this.state.width+e),2,y.columns),r=o.constrain(y.getColumnsFromSize(n,this.state.height+i),2,y.columns);return[s,r]},updateSize:function(t){var e=this.props.element;if("grid"===e.layout_type){var i=this.getGridDimensions(t),s=n(i,2),r=s[0],o=s[1],a={width:r,height:o};(e.grid_size.width!==r||e.grid_size.height!==o)&&this.update({grid_size:a}),this.setState({size:t,gridSize:a})}},dragStartResizeHandle:function(){var t=this.props.element;this.setState({x:this.getX(),y:this.getY(),gridSize:{width:t.grid_size.width,height:t.grid_size.height}}),this.update({isResizing:!0})},dragEndResizeHandle:function(){var t=this.props.element;if("grid"===t.layout_type){var e=this.getGridDimensions(this.state.size),i=n(e,2),s=i[0],r=i[1];this.setState({x:null,y:null,gridSize:null,width:y.getSizeOfColumns(this.props.windowWidth,s),height:y.getSizeOfColumns(this.props.windowWidth,r),size:{x:0,y:0}}),this.update({isResizing:!1})}},dragStart:function(t){t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="none",c.updateDragging({dragTarget:this.getDOMNode()});var e=this.props.element.id;t.dataTransfer.setData("text/plain",e),t.dataTransfer.setData("elementId",e),t.dataTransfer.setDragImage(this._dragImage=this._dragImage||this.createBlankImage(),0,0),this.setState({x:this.getX(),y:this.getY()}),this.update({isMoving:!0})},dragEnd:function(){this.setState({x:null,y:null})},hasFocus:function(){return this.isHovering()||this.state.focus},onFocus:function(){this.setState({focus:!0})},onBlur:function(){this.setState({focus:!1})},change:function(t){this.props.editing&&c.updateNewStoryElementText(this.props.element,t.target.value)},textStyle:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(t){c.updateNewStoryElementTextStyle(this.props.element,t)}),alignment:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(t){c.updateNewStoryElementAlignment(this.props.element,t)}),onDelete:function(){this.props.editing&&c.deleteNewStoryElement(this.props.element)},crop:function(){this.update({isCropping:!0})},updateFocalpoint:function(t){var e=this.getZoom();this.setState({focalpoint:{x:t.dx/(this.getWidth()*e),y:t.dy/(this.getHeight()*e)}})},dragEndPan:function(){c.updateNewStoryElementFocalpoint(this.props.element,this.getFocalpoint()),this.update({isPanning:!1}),this.setState({focalpoint:{x:0,y:0}})},getX:function(){return this.isGrid()?this.props.x-this.props.width/2:this.props.x},getY:function(){return this.props.y},getWidth:function(){return Math.max(1,this.state.width+this.state.size.x)},getHeight:function(){return Math.max(1,this.state.height+this.state.size.y)},getZoom:function(){return this.isImage()&&this.props.element.content.image.zoom},getFocalpoint:function(){return this.isImage()?{x:this.props.element.content.image.focalpoint.x+this.state.focalpoint.x,y:this.props.element.content.image.focalpoint.y+this.state.focalpoint.y}:void 0},someCropping:function(){return this.get("newStory.elements").some(function(t){return t.isCropping})},someHovering:function(){return this.get("newStory.elements").some(function(t){return t.isHovering})},toggleHovering:function(t){this.update({isHovering:t})},mouseEnter:function(){this.toggleHovering(!0)},mouseLeave:function(){this.toggleHovering(!1)},focus:function(){this.refs.storyElement&&this.refs.storyElement.focus()},gridWidth:function(){if(this.state.gridSize){var t=y.getSizeOfColumns(this.props.windowWidth,this.state.gridSize.width);return this.animated("gridWidth",t)}},gridHeight:function(){if(this.state.gridSize){var t=y.getSizeOfColumns(this.props.windowWidth,this.state.gridSize.height);return this.animated("gridHeight",t)}},heightChange:function(t){this.setState({height:t}),this.props.onHeightChange&&this.props.onHeightChange(t)},renderLayer:function(){if(this._layerDestroyed=!1,this.isMoving()&&this.props.element.moveCoordinates&&this.props.element.moveOffset){var t=this.props.element,e=this.getWidth(),i=this.getHeight(),n=this.props.element.moveOffset[0],s=this.props.element.moveOffset[1];return this.isGrid()&&(n+=e/2,s+=i/2),r.createElement(v,{className:"box-shadow-top fixed click-through z1",x:t.moveCoordinates[0]-n,y:t.moveCoordinates[1]-s,offsetX:0,offsetY:0,width:e,height:i,element:t,zoom:this.getZoom(),focalpoint:this.getFocalpoint(),editing:this.props.editing,parallax:!1,shouldAnimate:!1})}if(this.isHovering()&&!this.isCropping()&&!this.isResizing()&&!this.isMoving()){var o=this.isText()?b:w;return r.createElement(o,{target:this.refs.editable,h:"centered",v:"above",offsetTop:-10,borderColor:"blue",backgroundColor:"blue",onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave,onDelete:this.onDelete,onAlignment:this.alignment,onTextStyle:this.textStyle,onCrop:this.crop})}return this._layerDestroyed=!0,null},render:function(){var t=this.props.element,e=this.getX(),i=this.getY(),n=this.getWidth(),a=this.getHeight(),l=this.getZoom(),h=this.isGrid(),p=h?0:.5,c=this.someCropping()&&this.someHovering()&&!this.isHovering(),u=this.isMoving()||this.isResizing(),g=!this.isMoving()&&this.isCropping()&&this.isHovering()&&l>1,y=this.animated({key:"x",target:e,damping:30}),b=this.animated({key:"y",target:i,damping:30}),w={width:n,height:a,offsetX:p,offsetY:0},E={x:h?0:this.props.width/2,y:0,offsetX:p,offsetY:0},S={width:n,height:a,element:t,style:c&&{opacity:.5},zoom:l,focalpoint:this.getFocalpoint(),parallax:!1,rangy:this.props.rangy};return r.createElement("div",null,u&&r.createElement(d,s({},w,{x:y,y:b}),r.createElement(d,s({},E,{width:this.gridWidth()||n,height:this.gridHeight()||a,className:"light-gray-bg"}))),r.createElement(d,s({},w,{x:this.isResizing()?this.state.x:y,y:this.isResizing()?this.state.y:b,className:o.joinClasses(x({handle:!0,"move-pointer":!this.isCropping(),z1:this.hasFocus()}),this.props.className),onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave,onDragStart:this.dragStart,onDragEnd:this.dragEnd,draggable:!this.isCropping(),ref:"editable"}),g&&r.createElement(v,s({},E,S,{className:"click-through",crop:!1,style:{opacity:.5}})),r.createElement(v,s({},E,S,{className:x({hidden:this.isMoving()}),editing:this.props.editing,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.change,onHeightChange:this.heightChange,ref:"storyElement"})),r.createElement(f,{element:t,hasFocus:this.hasFocus(),onResizeStart:this.dragStartResizeHandle,onResizeChange:this.updateSize,onResizeEnd:this.dragEndResizeHandle}),r.createElement(m,{element:t,onPanEnd:this.dragEndPan,onPanChange:this.updateFocalpoint})))}});t.exports=S},206:function(t,e,i){"use strict";var n=function(t,e){var i={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(41),o=i(57),a=i(120),l=i(42),h=i(47),p=i(66),c=i(109),u=i(115),d=i(241),g=r.addons.classSet,m=r.createClass({displayName:"ExpandableStoryElement",mixins:[c,p,u],fastMixinProps:["element","expanded","staged","dragX","width","height","x","y","windowWidth","windowHeight"],componentWillMount:function(){this._shouldStartAnimating=!1,this._zIndex=null},componentWillReceiveProps:function(t){var e=!(!t.expanded&&!t.staged),i=!(!this.props.expanded&&!this.props.staged);if(e!==i){var n=window.scrollY||window.pageYOffset;this._yCompensation=e?-n:-n}var s=t.expanded&&!i,r=t.expanded&&this.props.staged,o=this.props.expanded&&!t.expanded,a=!e&&this.props.staged,l=this.props.staged&&t.staged&&this.props.staged!==t.staged&&!t.dragX;this._shouldStartAnimating=!!(s||o||r||l),this._shouldStopAnimating=a,this._expanding=s},componentDidUpdate:function(){this._expanding&&!this.isAnimating()&&(this._expanding=!1,this.props.onExpandingDone&&this.props.onExpandingDone())},setSwipeVelocity:function(t){this.setVelocity("x",t)},isGrabbed:function(){return!!this.props.dragX},isStagingOrUnstaging:function(){return this.props.staged&&!this.props.expanded},focus:function(){return this.refs.storyElement&&this.refs.storyElement.focus()},onHeightChange:function(){this.props.expandable&&this.isAnimating()&&!this.isGrabbed()||this.props.staged||this.props.expanded||this.props.onHeightChange&&this.props.onHeightChange.apply(null,arguments)},render:function(){var t=this.props,e=t.width,i=t.height,p=t.x,c=t.y,u=t.className,m=t.style,f=t.expandable,y=t.expanded,v=t.staged,b=t.element,w=t.windowWidth,x=t.windowHeight,E=t.isFirstInGrid,S=t.isLastInGrid,T=n(t,["width","height","x","y","className","style","expandable","expanded","staged","element","windowWidth","windowHeight","isFirstInGrid","isLastInGrid"]),C=this.isAnimating()&&!this.isGrabbed()&&!this._shouldStopAnimating||this._shouldStartAnimating;
if(y=y||v,this._shouldStartAnimating=!1,h.hasTouch()||h.isiOS()){l.updateSize();var _=l.getSize();w=_.width,x=_.height}var P,N,O,D,z;if(f){var k=b.content.image||b.content.video.poster_image,H=k.representations[Object.keys(k.representations)[0]],L=o.fit(w,x,H.size.width,H.size.height);P=L.width,N=L.height,O=w/2,D=(x-N)/2-(this._yCompensation||0);var R=0;if(R){var I=1;y&&(E&&R>0||S&&0>R)&&(I=2),R/=I}O+=this.animated({key:"x",target:v*w+20*v+R,animate:C,springiness:72,damping:14}),z=this.animated({key:"bounds",target:y?1:0,animate:C,springiness:500,damping:70,maxSnapDelta:.01,maxVelocityDelta:.01}),e+=(P-e)*z,i=i?i+(N-i)*z:null,p+=(O-p)*z,c+=(D-c)*z,y&&(c+=this._yCompensation||0)}return this._zIndex=y||C?this._zIndex||a.getZ():null,r.createElement(d,s({},T,f&&this.getClickMixinProps(),{element:b,className:o.joinClasses(u,g({fixed:y})),style:o.merge(m,{zIndex:this._zIndex}),isFixed:y,width:e,height:i,x:p,y:c,onHeightChange:this.onHeightChange,expandProgress:z,useTransforms:C,useTransformsForImages:C,freezeRepresentation:C,ref:"storyElement"}))}});t.exports=m},207:function(t,e,i){"use strict";function n(t,e,i){var n=i.x,s=i.y,r=i.height,o=s+r/2;return(n-t)*(n-t)+(o-e)*(o-e)}var s=i(57),r=i(47),o=i(244),a=i(43),l=5,h={computePositions:function(t){var e=new o(a.columns);e.increaseOffsetBy(this.props.y);var i=!1;return(t||this.props.elements).map(function(t,n){var o=this.isGridElement(t),l=this.isTextElement(t),h=this.isExpandableElement(t),p=o?t.grid_size.height:1,c=o?t.grid_size.width:a.columns;e.increaseOffsetBy(this.getMargin(this.props.elements[n-1],t));var u,d=e.findNextAvailablePosition(this.props.width,c,p);u=l?a.getGridWidth(this.props.width):!o&&r.hasTouch()?a.getFullWidth(this.props.width):a.getSizeOfColumns(this.props.width,c);var g=a.getSizeOfColumns(this.props.width,p),m=o?Math.round(d.left+u/2):this.props.width/2,f=Math.round(d.top),y=this.state["element-"+t.id+"-height"];return s.isSet(y)&&e.increaseOffsetBy(y-g),o||s.isSet(y)||(i=!0),{element:t,width:u,height:o?g:null,actualHeight:y,x:m,y:i?-1e4:f,isExpandable:h,isGrid:o}},this)},getClosestIndex:function(t,e,i){var s=(i||this.computePositions()).map(n.bind(null,t,e));return s.indexOf(s.reduce(function(t,e){return t>e?e:t},Number.MAX_VALUE))},findClosestIndex:function(t,e,i,r){for(var o,a,h,p=this.props.elements,c=this.getClosestIndex(e,i,r),u=Math.max(c-l,0),d=Math.min(c+l,p.length-1),g=u,m=Number.MAX_VALUE,f=Number.MAX_VALUE,y=u;d>=y;y++)if(o=this.computePositions(s.move(p,t,y))[y],a=n(e,i,o),!(a>f)){if(o=r[y],h=o.y-i,s.almostEqual(a,f,s.almostEqual.FLT_EPSILON,s.almostEqual.FLT_EPSILON)&&y>t){if(Math.abs(h)>Math.abs(m))continue;if(h!==m&&h>0)continue}m=h,g=y,f=a}return g}};t.exports=h},208:function(t,e,i){"use strict";var n=i(41),s=i(82),r=i(77),o=i(58),a=i(63),l=i(71),h=i(50),p=n.createClass({displayName:"DownloadAppButton",mixins:[h],getInitialState:function(){return{primerLink:null}},componentDidMount:function(){this.props.storyPage&&r.features.usePrimerLink&&this.fetchPrimerStoryLink()},fetchPrimerStoryLink:function(){a.get("/api2/stories_by_slug/"+this.get("story").slug+"/primer_url",{},this.onDoneFetchPrimerStoryLink)},onDoneFetchPrimerStoryLink:function(t,e){!t&&e.tracking_link&&this.setState({primerLink:e.tracking_link})},trackingHref:function(){return this.state.primerLink||l.storeLink(this.props.trackingSource)},setDownloadContextCookie:function(){s.set("download_app_from_story",this.get("story").slug)},onClick:function(t){if(this.setDownloadContextCookie(),!this.props.storyPage||!this.state.primerLink){var e=l.appStoreClick(this.props.trackingSource);e(t)}},render:function(){return n.createElement(o,{href:this.trackingHref(),onClick:this.onClick,className:"aa phm",buttonStyle:{outline:!0,color:"light-gray",innerColor:"white"},style:{borderRadius:5,fontSize:12,lineHeight:"28px"}},"Get App")}});t.exports=p},214:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(57),o=i(49),a=i(66),l=i(64),h=s.addons.classSet,p=s.createClass({displayName:"Footer",mixins:[a],render:function(){return s.createElement(l,n({},this.props,{className:r.joinClasses(this.props.className,h({center:!0,"pvh light-gray-border border-top mtl":!this.props.minimal,"pbh ptl":this.props.minimal}))}),s.createElement("a",{href:"/"},s.createElement(o,{icon:i(52),color:"light-gray",className:"ib mid"})),this.props.children)}});t.exports=p},237:function(t){"use strict";var e={};e.createBlankImage=function(){var t=document.createElement("canvas");t.width=1,t.height=1;var e=new Image;return e.src=t.toDataURL(),e},t.exports=e},238:function(t,e,i){"use strict";var n=i(41),s=i(100),r=n.PropTypes,o=["isCropping","isResizing","isMoving","isPanning","isHovering"],a=o.reduce(function(t,e){return t[e]=function(){return this.props.element[e]},t},{propTypes:{element:r.object.isRequired},update:function(t){s.updateNewStoryElement(this.props.element,t)},isImage:function(){return"image"===this.props.element.content.type},isText:function(){return"text"===this.props.element.content.type},isGrid:function(){return"grid"===this.props.element.layout_type},isBlock:function(){return"block"===this.props.element.layout_type}});t.exports=a},239:function(t,e,i){"use strict";var n=i(41),s=i(54),r=i(58),o=i(100),a=i(238),l=i(255),h=i(256),p=n.addons.classSet,c=n.createClass({displayName:"CropHandles",mixins:[a],updateZoom:function(t){o.updateNewStoryElementZoom(this.props.element,t.target.value)},panStart:function(){this.update({isPanning:!0,isCropping:!0})},cropEnd:function(){this.update({isCropping:!1})},renderGrid:function(){var t=n.createElement("td",{className:"white-border"}),e=n.createElement("tr",null,t,t,t);return n.createElement("table",{className:"abs white-border zero full-width full-height click-through",style:{borderCollapse:"collapse"}},n.createElement("tbody",null,e,e,e))},render:function(){if(!this.isCropping()||!this.isHovering())return null;var t=this.props,e=t.onPanEnd,i=t.onPanChange;return n.createElement("div",{className:"abs",style:{top:2,right:2,bottom:2,left:2}},this.renderGrid(),n.createElement("div",{className:"abs bottom-left bottom-right",style:{top:"50%"}},n.createElement(l,{className:p({"mhs phm rel z1":!0,hidden:this.isPanning()}),min:1,max:3,defaultValue:this.props.element.content.image.zoom,onChange:this.updateZoom}),n.createElement(r,{className:"rel block centered mts z1",buttonStyle:r.blueOutline,style:{width:100},action:this.cropEnd},s("Done"))),n.createElement(h,{className:"abs zero",onDragStart:this.panStart,onDragEnd:e,onChange:i}))}});t.exports=c},240:function(t,e,i){"use strict";var n=i(41),s=i(263),r=i(238),o=n.createClass({displayName:"ResizeHandles",mixins:[r],getBorderStyle:function(){var t="#00c4ff";return this.isImage()?{borderStyle:"solid",borderColor:t,borderWidth:2}:this.isText()?{borderStyle:"dotted",borderColor:t,borderWidth:1}:void 0},renderResizeHandles:function(){var t=this.props,e=t.onResizeStart,i=t.onResizeEnd,r=t.onResizeChange;return!this.isMoving()&&!this.isCropping()&&this.isHovering()&&this.isImage()?[{bottom:0,left:"50%",cursor:"s-resize"},{bottom:0,right:0,cursor:"se-resize"},{bottom:"50%",right:0,cursor:"e-resize"}].map(function(t,o){return n.createElement(s,{style:t,direction:t.cursor,onDragStart:e,onDragEnd:i,onChange:r,key:o})},this):void 0},render:function(){var t=this.props.hasFocus&&!this.isMoving();return n.createElement("div",null,n.createElement("div",{className:"abs zero move-pointer click-through",style:t?this.getBorderStyle():null},t&&n.createElement("div",{className:"abs zero white-border"})),this.renderResizeHandles())}});t.exports=o},241:function(t,e,i){"use strict";function n(t,e){return t.is_uploading||e.representations&&Object.keys(e.representations).length||console.warn("Image without representations",e),!0}function s(t,e){return e.representations&&e.representations.high||console.warn("Video without representations",e),!0}function r(t){return t.content.image&&!n(t,t.content.image)?!1:t.content.video&&!s(t,t.content.video)?!1:t.content.video&&!n(t,t.content.video.poster_image)?!1:!0}var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},a=i(41),l=i(66),h=i(91),p=i(257),c=a.createClass({displayName:"StoryElement",mixins:[l],fastMixinProps:["element","width","height","onScreen","isRendered","x","y","expandProgress","useTransforms","zoom","focalpoint","shouldAnimate"],focus:function(){this.refs.textElement&&this.refs.textElement.focus()},renderTextOnElement:function(){return this.props.element.title?a.createElement("div",{className:"valign-parent fill"},a.createElement("div",{className:"valign z1 center white b text-m",style:{backgroundColor:"rgba(0,0,0,0.35)"}},this.props.element.title)):null},render:function(){var t=this.props.element;if(!r(t))return a.createElement("div",null);switch(t.content.type){case"text":return a.createElement(p,o({},this.props,{content:t.content,offsetX:.5,offsetY:0,ref:"textElement"}));case"image":case"video":return a.createElement(h,o({},this.props,{content:t.content,isUploading:t.content[t.content.type].is_uploading}),this.renderTextOnElement());default:return console.warn("Content type not implemented",t),a.createElement("div",null)}}});t.exports=c},242:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(49),o=i(254),a=i(54),l=s.PropTypes,h=s.createClass({displayName:"TextElementFlyout",propTypes:{onDelete:l.func.isRequired},getInitialState:function(){return{mode:null}},setMode:function(t){this.setState({mode:t}),this.refs.flyout.measure()},setAlignment:function(t){this.props.onAlignment&&this.props.onAlignment(t),this.refs.flyout.measure()},setTextStyle:function(t){this.props.onTextStyle&&this.props.onTextStyle(t),this.refs.flyout.measure()},renderDefault:function(){return s.createElement("div",{className:"pas",style:{fontSize:0}},s.createElement("a",{role:"button",className:"ib pointer prs",onClick:this.setMode.bind(this,"textStyle")},s.createElement(r,{className:"block",icon:i(258),color:"white"})),s.createElement("a",{role:"button",className:"ib pointer phs border-left white-border",onClick:this.setMode.bind(this,"alignment")},s.createElement(r,{className:"block",icon:i(259),color:"white"})),s.createElement("a",{role:"button",className:"ib pointer pls border-left white-border",onClick:this.props.onDelete},s.createElement(r,{className:"block",icon:i(260),color:"white"})))},renderAlignment:function(){return s.createElement("div",{className:"pas",style:{fontSize:0}},s.createElement("a",{role:"button",className:"ib pointer prs",onClick:this.setAlignment.bind(this,"left")},s.createElement(r,{className:"block",icon:i(259),color:"white"})),s.createElement("a",{role:"button",className:"ib pointer phs border-left white-border",onClick:this.setAlignment.bind(this,"center")},s.createElement(r,{className:"block",icon:i(261),color:"white"})),s.createElement("a",{role:"button",className:"ib pointer pls border-left white-border",onClick:this.setAlignment.bind(this,"right")},s.createElement(r,{className:"block",icon:i(262),color:"white"})))},renderTextStyle:function(){return s.createElement("div",{className:"pas",style:{lineHeight:"30px"}},s.createElement("a",{role:"button",className:"ib white pointer prs",onClick:this.setTextStyle.bind(this,"header")},s.createElement("span",{className:"ib b",style:{height:30}},a("Header"))),s.createElement("a",{role:"button",className:"ib serif white pointer phs border-left white-border",onClick:this.setTextStyle.bind(this,"body")},s.createElement("span",{className:"ib",style:{height:30}},a("Normal"))),s.createElement("a",{role:"button",className:"ib light white pointer pls border-left white-border",onClick:this.setTextStyle.bind(this,"pull_quote")},s.createElement("span",{className:"ib",style:{height:30}},a("Quote"))))},renderButtons:function(){switch(this.state.mode){case"alignment":return this.renderAlignment();case"textStyle":return this.renderTextStyle();default:return this.renderDefault()}},render:function(){return s.createElement(o,n({},this.props,{ref:"flyout"}),this.renderButtons())}});t.exports=h},243:function(t,e,i){"use strict";var n=i(41),s=i(49),r=i(254),o=n.PropTypes,a=n.createClass({displayName:"ImageElementFlyout",propTypes:{onDelete:o.func.isRequired},render:function(){return n.createElement(r,this.props,n.createElement("div",{className:"pas",style:{fontSize:0}},n.createElement("a",{role:"button",className:"ib pointer prs",onClick:this.props.onCrop},n.createElement(s,{className:"block",icon:i(264),color:"white"})),n.createElement("a",{role:"button",className:"ib pointer pls border-left white-border",onClick:this.props.onDelete},n.createElement(s,{className:"block",icon:i(260),color:"white"}))))}});t.exports=a},244:function(t,e,i){"use strict";function n(t){this._numberOfColumns=t,this._offset=0,this._map=[],this._row=0,this._col=0}var s=i(43);n.prototype.increaseOffsetBy=function(t){this._offset+=t},n.prototype._isGridCellUsed=function(t,e){return this._map[t*this._numberOfColumns+e]},n.prototype._isGridAreaUsed=function(t,e,i,n){for(var s=t;t+n>s;s++)for(var r=e;e+i>r;r++)if(this._isGridCellUsed(s,r))return!0;return!1},n.prototype._setGridCellUsed=function(t,e){this._map[t*this._numberOfColumns+e]=!0},n.prototype._setGridAreaUsed=function(t,e,i,n){for(var s=t;t+n>s;s++)for(var r=e;e+i>r;r++)this._setGridCellUsed(s,r)},n.prototype._findNextAvailableCell=function(t,e){for(;;){if(this._col+t>this._numberOfColumns&&(this._row++,this._col=0),!this._isGridAreaUsed(this._row,this._col,t,e))return this._setGridAreaUsed(this._row,this._col,t,e),{row:this._row,column:this._col};this._col++}},n.prototype.findNextAvailablePosition=function(t,e,i){var n=this._findNextAvailableCell(e,i),r=s.getCellSize(t),o=s.getGutter(t);return{left:n.column*(r+o)+s.getMarginWidth(t),top:n.row*(r+o)+this._offset}},t.exports=n},254:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(57),o=i(49),a=i(120),l=i(106),h=i(47),p=i(66),c=i(115),u=i(109),d=i(59),g=s.addons.classSet,m=s.createClass({displayName:"Flyout",mixins:[c,d,u,p],getDefaultProps:function(){return{offsetLeft:0,offsetTop:h.hasTouch()?16:0,h:"right",v:"below",dim:h.hasTouch(),dark:!0,opacity:.4,borderColor:"light-gray",backgroundColor:"white"}},getInitialState:function(){return this._offsetX=Math.random(),this._offsetY=Math.random(),this._rotateZ=360*Math.random()-180,{windowWidth:0,hiding:!1}},componentDidMount:function(){this.measure()},componentDidUpdate:function(){this.props.hiding&&!this.isAnimating()&&(this.props.onDestroy(),this._offsetX=Math.random(),this._offsetY=Math.random(),this._rotateZ=360*Math.random()-180)},onClick:function(t){t.stopPropagation()},onResize:function(t){this.setState({windowWidth:t.windowWidth}),this.measure()},measure:r.frame(function(){var t=this.props.target.getDOMNode(),e=this.refs.flyout.getDOMNode();this.setState({targetBounds:t.getBoundingClientRect(),flyoutBounds:e.getBoundingClientRect()})}),getLeft:function(){if(h.hasTouch())return this.state.windowWidth/2-160;var t=this.props.fixed?0:document.body.scrollLeft;switch(this.props.h){case"right":return t+this.state.targetBounds.left+this.state.targetBounds.width-this.state.flyoutBounds.width;case"left":return t+this.state.targetBounds.left;case"centered":return t+this.state.targetBounds.left+this.state.targetBounds.width/2-this.state.flyoutBounds.width/2}},getTop:function(){var t=this.props.fixed?0:document.body.scrollTop;switch(this.props.v){case"above":return t+this.state.targetBounds.top-this.state.flyoutBounds.height;case"below":return t+this.state.targetBounds.top+this.state.targetBounds.height}},getPointStyle:function(){var t={};switch(this.props.v){case"above":t=r.merge(t,{top:"100%"});break;case"below":t=r.merge(t,{top:-8,right:13})}switch(this.props.h){case"left":t=r.merge(t,{left:16});break;case"centered":t=r.merge(t,{left:"50%",marginLeft:-6})}return t},render:function(){var t=this.state.targetBounds&&this.state.flyoutBounds,e=t?this.getLeft()+this.props.offsetLeft:-1e4,r=t?this.getTop()+this.props.offsetTop:0;return s.createElement(a,n({},this.props,{target:null,dim:h.hasTouch()&&!this.props.hiding}),this.clickEvents(s.createElement("div",{ref:"flyout",className:[g({"flyout z1":!0,"m-flyout":h.hasTouch(),fixed:this.props.fixed,abs:!this.props.fixed}),this.props.backgroundColor+"-bg",this.props.borderColor+"-border"].join(" "),style:l.transformStyle({left:e,top:r,translateY:h.hasTouch()?this.animated({key:"translateY",target:this.props.hiding?1024:0,start:1024,springiness:this.props.hiding?80:230}):null,rotateZ:h.hasTouch()?this.animated({key:"rotateZ",target:this.props.hiding?this._rotateZ:0,springiness:this.props.hiding?80:230}):null,offsetX:h.hasTouch()?this._offsetX:null,offsetY:h.hasTouch()?this._offsetY:null})},this.props.children,s.createElement(o,{className:"abs",icon:i(269),color:this.props.backgroundColor,iconStyle:this.props.borderColor,data:{reflect:"above"===this.props.v},style:this.getPointStyle()}))))}});t.exports=m},255:function(t,e,i){"use strict";var n=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var i,n=[],s=t[Symbol.iterator]();!(i=s.next()).done&&(n.push(i.value),!e||n.length!==e););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(41),o=i(57),a=i(49),l=i(237),h=i(147),p=i(100),c=r.createClass({displayName:"Slider",mixins:[l,h],getDefaultProps:function(){return{min:0,max:1,size:15,defaultValue:0}},getInitialState:function(){return{value:(this.props.defaultValue-this.props.min)/(this.props.max-this.props.min)}},componentDidUpdate:function(t,e){this.state.value!==e.value&&this.props.onChange&&this.props.onChange({target:{value:this.getValue()}})},getValue:function(){return this.props.min+(this.props.max-this.props.min)*this.state.value},getRangeRect:function(){return this.refs.range.getDOMNode().getBoundingClientRect()},click:function(t){var e=this.getRangeRect();this.setState({value:o.linear(e.left,0,e.right,1)(t.clientX)})},dragStart:function(t){t.stopPropagation(),t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="none",t.dataTransfer.setData("text/plain",""),t.dataTransfer.setDragImage(this._dragImage=this._dragImage||this.createBlankImage(),0,0),this._rect=this.getRangeRect(),p.updateDragging({dragTarget:this.getDOMNode()})},drag:function(t){var e=this.getDragCoordinates(t),i=n(e,1),s=i[0];s&&(t.stopPropagation(),this.setState({value:o.linear(this._rect.left,0,this._rect.right,1)(s)}))},dragEnd:function(t){t.stopPropagation(),p.updateDragging({dragTarget:void 0}),this.props.onDragEnd&&this.props.onDragEnd(t)},drop:function(t){t.stopPropagation()},render:function(){var t=this.props.size;return r.createElement("div",s({},this.props,{className:o.joinClasses(this.props.className),onChange:null}),r.createElement("div",{className:"rel",style:{height:t},onClick:this.click},r.createElement("div",{className:"abs blue-border border-top-bottom",style:{top:"50%",left:0,right:0,marginTop:-2},ref:"range"}),r.createElement(a,{className:"abs cursor",style:{left:100*this.state.value+"%",top:"50%",marginLeft:t/-2,marginTop:t/-2},icon:i(270),width:t,height:t,data:t/2,iconStyle:"blue",color:"blue",draggable:!0,onDragStart:this.dragStart,onDrag:this.drag,onDragEnd:this.dragEnd,onDrop:this.drop})))}});t.exports=c},256:function(t,e,i){"use strict";var n=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var i,n=[],s=t[Symbol.iterator]();!(i=s.next()).done&&(n.push(i.value),!e||n.length!==e););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(41),o=i(57),a=i(100),l=i(237),h=i(147),p=r.createClass({displayName:"Pan",mixins:[l,h],dragStart:function(t){this._position=this.getDragCoordinates(t),t.stopPropagation(),t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="none",t.dataTransfer.setDragImage(this._dragImage=this._dragImage||this.createBlankImage(),0,0),a.updateDragging({dragTarget:this.getDOMNode()}),this.props.onDragStart&&this.props.onDragStart(t)},drag:function(t){t.stopPropagation();var e=this.getDragCoordinates(t),i=n(e,2),s=i[0],r=i[1];if(s||r){var o=n(this._position,2),a=o[0],l=o[1];this.props.onChange&&this.props.onChange({dx:a-s,dy:l-r})}},dragEnd:function(t){t.stopPropagation(),a.updateDragging({dragTarget:void 0}),this.props.onDragEnd&&this.props.onDragEnd(t)},drop:function(t){t.stopPropagation()},render:function(){return r.createElement("div",s({},this.props,{className:o.joinClasses(this.props.className,"grabbing"),draggable:!0,onDragStart:this.dragStart,onDrag:this.drag,onDragEnd:this.dragEnd,onDrop:this.drop,onChange:null}))}});t.exports=p},257:function(t,e,i){"use strict";function n(t){return-(t*(t-2))}var s=function(t,e){var i={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},o=i(41),a=i(76),l=i(57),h=i(77),p=i(47),c=i(67),u=i(64),d=i(178),g=i(271),m=i(43),f=i(111),y=o.addons.classSet,v={pull_quote:1.4,header:1.3,body:1.8},b={header:.485,pull_quote:.485,body:.535},w={header:.53,pull_quote:.53,body:.57},x=o.createClass({displayName:"TextElement",mixins:[d,c],getDefaultProps:function(){return{parallax:!0}},heightInvalidationProps:["element","width"],shouldComponentUpdate:function(t,e){return this.props.width!==t.width||this.props.x!==t.x||this.props.y!==t.y||this.props.element!==t.element||this.hasParallax()&&Math.abs(this.getParallaxRatio(t,e))<1},getInitialState:function(){return this._text=a.toElementsWithLinks(this.props.content.text),{height:null}},componentDidMount:function(){this.startScrollListener()},componentWillReceiveProps:function(t){this._text=a.toElementsWithLinks(t.content.text)},getFontSize:function(){var t=f[this.props.content.text.text_style];return t(m.getGridWidth(this.props.width))},getLineHeight:function(t){var e=m.getGutter(this.props.width),i=Math.ceil(t*v[this.props.content.text.text_style]/e);return e*i},getTopAdjustment:function(t,e){if(!h.features.grid)return 0;if(!t)return 0;var i=b[this.props.content.text.text_style]*t,n=w[this.props.content.text.text_style];return(e-i)*n+i-m.getGutter(this.props.width)},getBottomAdjustment:function(t,e){if(!h.features.grid)return 0;if(!t)return 0;var i=b[this.props.content.text.text_style]*t,n=w[this.props.content.text.text_style];return(e-i)*(1-n)},hasParallax:function(){return this.props.parallax&&this.state.height&&!p.hasTouch()&&"pull_quote"==this.props.content.text.text_style},getParallaxRatio:function(t,e){var i=t.y-e.windowHeight,n=t.y+this._height;return(e.scrollTop-i)/(n-i)},onHeightChange:function(t){var e=this.getFontSize(),i=this.getLineHeight(e,this.props.width);this.setState({height:t+this.getTopAdjustment(e,i)+this.getBottomAdjustment(e,i)})},change:function(t){this._measureHeightFrame(),this.props.onChange&&this.props.onChange(t)},focus:function(){this.refs.editableTextElement&&this.refs.editableTextElement.focus()},render:function(){var t=this.props,e=(t.height,t.y),i=t.content,a=(t.scrollTop,t.onDelete),p=t.onFocus,c=t.onBlur,d=t.onAlignment,m=t.onTextStyle,f=t.onHeightChange,v=t.className,b=t.style,w=t.rangy,x=s(t,["height","y","content","scrollTop","onDelete","onFocus","onBlur","onAlignment","onTextStyle","onHeightChange","className","style","rangy"]),E=this.getFontSize(),S=this.getLineHeight(E,this.props.width),T=this.hasParallax()?this.getParallaxRatio(this.props,this.state):null,C=l.linear(0,30,1,-30),_=l.linear(0,1,1,-1),P=this._text;return this.props.editing&&(P=o.createElement(g,{content:i,rangy:w,onChange:this.change,onDelete:a,onFocus:p,onBlur:c,onAlignment:d,onTextStyle:m,onHeightChange:f,ref:"editableTextElement"})),o.createElement(u,r({},x,{className:l.joinClasses(v,y({"text abs pre":!0,aa:E>16,header:"header"==i.text.text_style,body:"body"==i.text.text_style,pull_quote:"pull_quote"==i.text.text_style,center:"center"===i.text.alignment,right:"right"===i.text.alignment})),y:e+this.getTopAdjustment(E,S),style:Object.assign({},b,{fontSize:E,lineHeight:h.features.grid?S+"px":null,opacity:T?n(1-Math.abs(_(T))):null}),transform:{translateY:T?Math.round(C(T)):null},onHeightChange:f}),P)}});t.exports=x},258:function(t){"use strict";function e(t){t.beginPath(),t.moveTo(1001.3,1008),t.lineTo(997.9,1008),t.lineTo(996.5,1004.3),t.lineTo(989.7,1004.3),t.lineTo(988.3,1008),t.lineTo(985,1008),t.lineTo(991.2,992),t.lineTo(995.1,992),t.lineTo(1001.3,1008),t.closePath(),t.moveTo(990.8,1001.3),t.lineTo(995.4,1001.3),t.lineTo(993.1,995.2),t.lineTo(990.8,1001.3),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1012.7,1004.8),t.bezierCurveTo(1012.7,1005.8,1013.1,1006.4,1013.8,1006.4),t.bezierCurveTo(1014,1006.4,1014.4,1006.3,1014.8,1006.2),t.lineTo(1015,1006.9),t.bezierCurveTo(1014.2,1007.7,1013.5,1008,1012.7,1008),t.bezierCurveTo(1011.5,1008,1010.9,1007.2,1010.6,1006),t.bezierCurveTo(1009.7,1006.9,1008.5,1008,1006.4,1008),t.bezierCurveTo(1004.2,1008,1003,1006.7,1003,1004.9),t.bezierCurveTo(1003,1002.9,1004.5,1002.4,1006.2,1001.9),t.lineTo(1010.5,1000.6),t.lineTo(1010.5,1000.1),t.bezierCurveTo(1010.5,998.3,1009.7,996.9,1007.7,996.9),t.bezierCurveTo(1006.5,996.9,1005.9,997.4,1005.9,998.5),t.bezierCurveTo(1005.9,998.7,1005.9,999.2,1006,999.6),t.lineTo(1004.1,999.8),t.bezierCurveTo(1003.8,999.5,1003.6,999.2,1003.6,998.6),t.bezierCurveTo(1003.6,996.8,1005.7,995.7,1008.2,995.7),t.bezierCurveTo(1010.9,995.7,1012.7,996.8,1012.7,1e3),t.lineTo(1012.7,1004.8),t.closePath(),t.moveTo(1010.5,1005),t.lineTo(1010.5,1001.7),t.lineTo(1006.6,1002.9),t.bezierCurveTo(1005.8,1003.2,1005.4,1003.6,1005.4,1004.5),t.bezierCurveTo(1005.4,1005.7,1006.2,1006.4,1007.4,1006.4),t.bezierCurveTo(1008.7,1006.4,1009.5,1005.8,1010.5,1005),t.closePath(),t.fill()}e.size={width:30,height:30},t.exports=e},259:function(t){"use strict";function e(t){t.beginPath(),t.moveTo(1011,1004),t.lineTo(989,1004),t.lineTo(989,1001),t.lineTo(1011,1001),t.lineTo(1011,1004),t.closePath(),t.fill(),t.beginPath(),t.moveTo(989,996),t.lineTo(1004,996),t.lineTo(1004,999),t.lineTo(989,999),t.lineTo(989,996),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1004,1009),t.lineTo(989,1009),t.lineTo(989,1006),t.lineTo(1004,1006),t.lineTo(1004,1009),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1011,994),t.lineTo(989,994),t.lineTo(989,991),t.lineTo(1011,991),t.lineTo(1011,994),t.closePath(),t.fill()}e.size={width:30,height:30},t.exports=e},260:function(t){"use strict";function e(t){t.beginPath(),t.moveTo(1003,990),t.lineTo(1003,988),t.lineTo(997,988),t.lineTo(997,990),t.lineTo(992,990),t.lineTo(992,994),t.lineTo(1008,994),t.lineTo(1008,990),t.lineTo(1003,990),t.closePath(),t.fill(),t.beginPath(),t.moveTo(992,996),t.lineTo(992,1010),t.lineTo(1008,1010),t.lineTo(1008,996),t.lineTo(992,996),t.closePath(),t.moveTo(997,1008),t.lineTo(995,1008),t.lineTo(995,998),t.lineTo(997,998),t.lineTo(997,1008),t.closePath(),t.moveTo(1001,1008),t.lineTo(999,1008),t.lineTo(999,998),t.lineTo(1001,998),t.lineTo(1001,1008),t.closePath(),t.moveTo(1005,1008),t.lineTo(1003,1008),t.lineTo(1003,998),t.lineTo(1005,998),t.lineTo(1005,1008),t.closePath(),t.fill()}e.size={width:30,height:30},t.exports=e},261:function(t){"use strict";function e(t){t.beginPath(),t.moveTo(1011,1004),t.lineTo(989,1004),t.lineTo(989,1001),t.lineTo(1011,1001),t.lineTo(1011,1004),t.closePath(),t.fill(),t.beginPath(),t.moveTo(993,996),t.lineTo(1007,996),t.lineTo(1007,999),t.lineTo(993,999),t.lineTo(993,996),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1007,1009),t.lineTo(993,1009),t.lineTo(993,1006),t.lineTo(1007,1006),t.lineTo(1007,1009),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1011,994),t.lineTo(989,994),t.lineTo(989,991),t.lineTo(1011,991),t.lineTo(1011,994),t.closePath(),t.fill()}e.size={width:30,height:30},t.exports=e},262:function(t){"use strict";function e(t){t.beginPath(),t.moveTo(1011,1004),t.lineTo(989,1004),t.lineTo(989,1001),t.lineTo(1011,1001),t.lineTo(1011,1004),t.closePath(),t.fill(),t.beginPath(),t.moveTo(996,996),t.lineTo(1011,996),t.lineTo(1011,999),t.lineTo(996,999),t.lineTo(996,996),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1011,1009),t.lineTo(996,1009),t.lineTo(996,1006),t.lineTo(1011,1006),t.lineTo(1011,1009),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1011,994),t.lineTo(989,994),t.lineTo(989,991),t.lineTo(1011,991),t.lineTo(1011,994),t.closePath(),t.fill()}e.size={width:30,height:30},t.exports=e},263:function(t,e,i){"use strict";var n=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var i,n=[],s=t[Symbol.iterator]();!(i=s.next()).done&&(n.push(i.value),!e||n.length!==e););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(41),o=i(57),a=i(49),l=i(100),h=i(237),p=i(147),c=r.PropTypes,u=r.createClass({displayName:"ResizeHandle",mixins:[h,p],propTypes:{direction:c.string.isRequired},getDefaultProps:function(){return{size:15}},dragStart:function(t){var e=this.getDragCoordinates(t),i=n(e,2),s=i[0],r=i[1];t.stopPropagation(),t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="none",t.dataTransfer.setData("text/plain",""),t.dataTransfer.setDragImage(this._dragImage=this._dragImage||this.createBlankImage(),0,0),this._x=s,this._y=r,l.updateDragging({dragTarget:this.getDOMNode()}),this.props.onDragStart&&this.props.onDragStart(t)},drag:function(t){t.stopPropagation();var e=this.getDragCoordinates(t),i=n(e,2),s=i[0],r=i[1];(s||r)&&this.props.onChange&&this.props.onChange({x:"s-resize"===this.props.direction?0:s-this._x,y:"e-resize"===this.props.direction?0:r-this._y})},dragEnd:function(t){t.stopPropagation(),l.updateDragging({dragTarget:void 0}),this.props.onDragEnd&&this.props.onDragEnd(t)},drop:function(t){t.stopPropagation()},render:function(){var t=this.props.size;return r.createElement(a,s({},this.props,{className:o.joinClasses(this.props.className,"abs z1 pas"),style:o.merge(this.props.style,{marginRight:-15,marginBottom:-15}),icon:i(270),width:t,height:t,iconStyle:"blue",color:"blue",data:t/2,onDragStart:this.dragStart,onDrag:this.drag,onDragEnd:this.dragEnd,onDrop:this.drop,onChange:null,draggable:!0}))}});t.exports=u},264:function(t){"use strict";function e(t){t.beginPath(),t.moveTo(998,993),t.lineTo(998,997),t.lineTo(1003,997),t.lineTo(1003,1011),t.lineTo(1007,1011),t.lineTo(1007,993),t.lineTo(998,993),t.closePath(),t.fill(),t.beginPath(),t.moveTo(989,993),t.lineTo(989,997),t.lineTo(992,997),t.lineTo(992,993),t.lineTo(989,993),t.closePath(),t.fill(),t.beginPath(),t.moveTo(993,993),t.lineTo(993,997),t.lineTo(997,997),t.lineTo(997,993),t.lineTo(993,993),t.closePath(),t.fill(),t.beginPath(),t.moveTo(997,1003),t.lineTo(997,989),t.lineTo(993,989),t.lineTo(993,1003),t.lineTo(993,1007),t.lineTo(997,1007),t.lineTo(1002,1007),t.lineTo(1002,1003),t.lineTo(997,1003),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1003,1003),t.lineTo(1003,1007),t.lineTo(1007,1007),t.lineTo(1007,1003),t.lineTo(1003,1003),t.closePath(),t.fill(),t.beginPath(),t.moveTo(1008,1003),t.lineTo(1008,1007),t.lineTo(1011,1007),t.lineTo(1011,1003),t.lineTo(1008,1003),t.closePath(),t.fill()
}e.size={width:30,height:30},t.exports=e},269:function(t){"use strict";function e(t,e,i){(i||{}).reflect&&(t.translate(1e3,1e3),t.scale(1,-1),t.translate(-1e3,-1e3)),t.beginPath(),t.moveTo(1007,1004),t.lineTo(1e3,996),t.lineTo(993,1004),t.strokeStyle=e,t.stroke(),t.closePath(),t.fill()}e.styles={blue:"#00c4ff","light-gray":"#ccc"},e.size={width:14,height:8},t.exports=e},270:function(t){"use strict";function e(t,e,i){var n="string"!=typeof e;n&&e[1]&&(t.beginPath(),t.arc(1e3,1e3,i,2*Math.PI,0),t.moveTo(1e3+i+2,1e3-i-2),t.lineTo(1e3-i-2,1e3-i-2),t.lineTo(1e3-i-2,1e3+i+2),t.lineTo(1e3+i+2,1e3+i+2),t.fillStyle=e[1],t.fill()),t.beginPath(),t.arc(1e3,1e3,i-.25,0,2*Math.PI),t.lineWidth=1,n?(t.strokeStyle=e[0],t.stroke()):(t.strokeStyle=e,t.fill())}e.styles={blue:"#00c4ff",dark:["rgba(0,0,0,0.2)","#fff"],"dark-transparent":["rgba(0,0,0,0.2)"],"light-transparent":["rgba(255,255,255,0.5)"]},t.exports=e},271:function(t,e,i){"use strict";var n=function(t,e){var i={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(41),o=i(273),a=i(108),l=r.PropTypes,h=r.createClass({displayName:"EditableTextElement",mixins:[a],propTypes:{content:l.object.isRequired,onChange:l.func},focus:function(){this.refs.input&&this.refs.input.focus()},render:function(){var t=this.props,e=t.content,i=n(t,["content"]);return r.createElement("div",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},r.createElement(o,s({},i,{value:e.text.plain_text,style:{border:"none",padding:0},ref:"input"})))}});t.exports=h},273:function(t,e,i){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(41),r=i(76),o=i(57),a=i(66),l=i(146),h=i(178),p=s.addons.classSet,c=s.createClass({displayName:"ContentEditable",mixins:[h,a],focus:o.frame(function(){this.refs.input&&this.refs.input.getDOMNode().focus()}),blur:o.frame(function(){this.refs.input&&this.refs.input.getDOMNode().blur()}),render:function(){return s.createElement("div",{ref:"input",key:"html",onKeyDown:this.props.onKeyDown,onInput:this.props.onInput,contentEditable:this.props.rangy?!0:null,className:"text-input pre",dangerouslySetInnerHTML:{__html:this.props.html}})}}),u=s.createClass({displayName:"RichInput",mixins:[l,a],getInitialState:function(){return{html:this.highlight(this.props.value)}},componentDidMount:function(){this.props.lazyloadRangy||this.getRangy()||this.loadRangy()},componentWillReceiveProps:function(t){this.props.value!==t.value&&this.setValue(t.value)},getRangy:function(){return this.state.rangy||this.props.rangy},onInput:function(){void 0===this.props.value&&this.setValue(this.getValue()),this.props.onChange&&this.props.onChange({target:{value:this.getValue()}})},componentDidUpdate:function(){this.restoreCursor()},setValue:function(t){this.getRangy()&&this.saveCursor(),this.setState({html:this.highlight(t)})},getValue:function(){return this.getRangy().innerText(this.refs.input.getDOMNode()).replace(/\n$/,"\n ")},hasValue:function(){return!!this.state.html},highlight:function(t){return r.linkify(t)},saveCursor:function(){var t=this.getRangy().getSelection();this._selection={selection:t,range:t.saveCharacterRanges(this.refs.input.getDOMNode())}},restoreCursor:function(){this._selection&&(this._selection.selection.restoreCharacterRanges(this.refs.input.getDOMNode(),this._selection.range),this._selection=null)},putCaretAtEnd:function(){var t=this.refs.input.getDOMNode().childNodes;if(t.length){var e=t[t.length-1],i=this.getRangy(),n=i.getSelection(),s=i.createRange();s.setStartAfter(e),s.setEndAfter(e),n.removeAllRanges(),n.addRange(s)}},renderContentEditable:function(){return!this.props.lazyloadRangy&&this.getRangy()||this.props.lazyloadRangy?s.createElement("div",{className:"textarea crop light-gray-border",style:o.merge(this.props.style,{cursor:"text"})},s.createElement(c,{html:this.state.html,rangy:this.getRangy(),onInput:this.onInput,onHeightChange:this.props.onHeightChange,onKeyDown:this.props.onKeyDown,ref:"input"})):void 0},handleFocus:function(){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus.apply(this,arguments)},handleBlur:function(){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur.apply(this,arguments)},focus:o.frame(function(t){t&&t.putCaretAtEnd&&this.putCaretAtEnd(),this.refs.input&&this.refs.input.focus()}),blur:o.frame(function(){this.refs.input&&this.refs.input.blur()}),loadRangyAndFocus:function(t){this.getRangy()||(t&&t.preventDefault(),this.loadRangy(this.props.onFocus))},showPlaceholder:function(){return!(this.hasValue()||this.props.hideLabelOnFocus&&this.state.focused)},render:function(){return s.createElement("label",n({},this.props,{ref:"label",className:o.joinClasses(this.props.className,"block rel"),onMouseDown:this.loadRangyAndFocus,onFocus:this.handleFocus,onBlur:this.handleBlur,onClick:this.focus}),s.createElement("span",{className:p({"placeholder full-width bb":!0,on:this.showPlaceholder(),focused:this.state.focused})},this.props.label),this.renderContentEditable())}});t.exports=u}});